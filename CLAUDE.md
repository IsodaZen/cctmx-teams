# CLAUDE.md

このファイルは、このリポジトリでコードを扱う際にClaude Code (claude.ai/code) へのガイダンスを提供します。

## **IMPORTANT**: AI（Claude）の行動指針

- **不明点は質問する**: 予測や推測で判断せず、不明点がある場合は必ずユーザーに質問してください
- **AskUserQuestionの活用**: ユーザーの意図や選択肢を確認する際は、AskUserQuestionツールを積極的に使用してください
- **ファイルの事前読み込み**: プラグインを修正する前に、必ず既存のファイルを読み込んで内容を理解してください
- **一貫性の維持**: コマンド名、ドキュメント、実装の間で一貫性を保ってください
- **日本語での記述**: すべての出力、ドキュメント、コメントは日本語で記述してください

## **MANDATORY**: SDD（仕様駆動開発）制約

> **本プロジェクトへのすべての変更は、SDD（Specification-Driven Development）の原則に従わなければならない。**
> これはコマンドの利用有無に関わらず適用される絶対的な制約である。

### 原則

1. **要求 → 設計 → 実装の一貫性**: すべての変更は「何を（要求）」「どう（設計）」「実装」の3層で整合性を維持すること
2. **変更の追跡可能性**: どの変更も、その根拠（要求）と設計判断を追跡できる状態にすること
3. **仕様の先行**: コードを書く前に、変更の目的と影響範囲を明確にすること

### 変更レベルと必須プロセス

変更の規模に応じて、以下のプロセスを適用する。

#### レベル1: 新機能開発（フルSDD）

対象: 新スキル追加、大きな機能変更、アーキテクチャ変更

1. `/kiro:spec-init` で仕様を初期化
2. `/kiro:spec-requirements` で要件定義
3. `/kiro:spec-design` で設計
4. `/kiro:spec-tasks` でタスク分解
5. `/kiro:spec-impl` で実装
6. `.kiro/specs/<feature>/` 配下に全成果物を記録

#### レベル2: 中規模修正（簡易SDD）

対象: 既存機能の改善、バグ修正、設定変更、ドキュメント構造変更

1. **要求の明文化**: 変更の目的・背景をコミットメッセージまたはTodoで明記
2. **影響範囲の確認**: 関連ファイル・仕様書を事前に読み込み、影響範囲を把握
3. **設計判断の記録**: なぜその実装方法を選んだかをコミットメッセージに記載
4. **既存仕様との整合**: 関連する `.kiro/specs/` の仕様書がある場合は整合性を確認し、必要に応じて仕様書も更新

#### レベル3: 軽微な修正（最小SDD）

対象: typo修正、コメント修正、フォーマット調整

1. **目的の明確化**: 何を・なぜ変更するか、最低限の理由を明確にしてから着手
2. **既存仕様の非破壊確認**: 変更が既存の仕様・設計に矛盾しないことを確認

### 禁止事項

- **仕様なき機能追加の禁止**: 要求が不明確なまま新機能を実装してはならない
- **仕様との乖離の放置禁止**: 実装が仕様と異なる状態を認識しつつ放置してはならない。実装を変えるか、仕様を更新すること
- **暗黙の設計判断の禁止**: 設計上の判断を行った場合、その理由を記録せず進めてはならない

## プロジェクト概要

**cctmx-teams** は、tmux環境でClaude Codeを複数起動し、リーダー・ワーカーパターンで効率的に開発するためのClaude Codeプラグインです（MIT License）。

### 主な機能

- リーダー・ワーカーパターンによるAI役割分離
- SessionStart Hookによる自動環境判定
- 構造化指示によるタスク委譲（tmux-send）
- ワーカー成果物のレビューとエラー検知

### 開発ワークフロー

本プロジェクトでは **cc-sdd**（仕様駆動開発）を採用しています。詳細なプロセスは上記「**MANDATORY**: SDD（仕様駆動開発）制約」セクションを参照してください。

- **仕様書**: `.kiro/specs/<feature>/` 配下（requirements.md, design.md, tasks.md, research.md）
- **プロジェクトメモリ**: `.kiro/steering/`（product.md, structure.md, tech.md）
- **新機能開発（レベル1）**: `/kiro:spec-init` → `/kiro:spec-requirements` → `/kiro:spec-design` → `/kiro:spec-tasks` → `/kiro:spec-impl` の順で実施
- **中規模修正（レベル2）**: 要求明文化 → 影響範囲確認 → 設計判断記録 → 仕様整合確認
- **軽微な修正（レベル3）**: 目的明確化 → 既存仕様の非破壊確認

### プロジェクト構造

- `skills/` — 4つのスキル（tmux-worker, tmux-send, tmux-review, tmux-check）
- `commands/` — コマンド（setup）
- `hooks/` — フック（SessionStart）
- `templates/` — テンプレート（cctmx-team.md）
- `tests/` — 自動テスト（`bash tests/run-tests.sh`）
- `.kiro/specs/` — cc-sdd仕様書
- `.kiro/steering/` — プロジェクトメモリ
- `docs/` — テストガイド、開発履歴アーカイブ
